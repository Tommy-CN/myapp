<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>登录／注册／忘记密码</title>
  <link rel="stylesheet" href="stylesheets/style.css">
</head>

<body>
  <% include common/header.ejs %>
    <section class="sign_in sign">
      <form action="">
        <div class="form_title">登录</div>
        <input type="text" name="email" maxlength="20" id="in_email">
        <input type="password" name="password" maxlength="16" id="in_password">
        <button type="button" id="signIn">登录</button>
      </form>
    </section>
    <section class="sign_up sign">
      <form action="">
        <div class="form_title">注册</div>
        <input type="text" name="email" maxlength="20" id="up_email">
        <!-- <input type="text" name="code" maxlength="6"> -->
        <input type="password" name="password" maxlength="16" id="up_password">
        <input type="text" name="code" maxlength="6" id="up_code">
        <button type="button" id="up_send">发送验证码</button>
        <button type="button" id="singUp">注册</button>
      </form>
    </section>
    <section class="forget sign">
      <form action="">
        <div class="form_title">忘记密码</div>
        <input type="text" name="email" maxlength="20" id="forget_email">
        <input type="text" name="code" maxlength="6" id="forget_code">
        <input type="password" name="password" maxlength="16" id="forget_password">
        <button type="button" id="forget_btn">提交</button>
      </form>
    </section>
    <% include common/footer.ejs %>
      <script src="javascripts/jquery-2.1.4.min.js"></script>
      <script>
      $(document).ready(function() {
        getNickName();
      })
      //注册发送邮箱验证码
      $('#up_send').click(function() {
        var email = $('#up_email').val();
        $.ajax({
          url: '/sign/sendEmail',
          data: { email: email },
          type: 'post',
          success: function(json) {
            console.log(json);
          },
          error: function() {
            console.log("连接失败");
          }
        })
      })
      //注册
      $('#singUp').click(function() {
        var email = $('#up_email').val()
        var password = $('#up_password').val()
        var code = $('#up_code').val()
        $.ajax({
          url: '/sign/signUp',
          data: { email: email, password: password, code: code },
          type: 'post',
          success: function(json) {
            console.log(json);
          },
          error: function() {
            console.log("连接失败");
          }
        })
      })
      //忘记密码
      $('#forget_btn').click(function() {
        var email = $('#forget_email').val()
        var password = $('#forget_password').val()
        var code = $('#forget_code').val()
        $.ajax({
          url: '/sign/forget',
          data: { email: email, password: password, code: code },
          type: 'post',
          success: function(json) {
            console.log(json);
          },
          error: function() {
            console.log("连接失败");
          }
        })
      })
      //登录
      $('#signIn').click(function() {
        var email = $('#in_email').val();
        var password = $('#in_password').val();
        $.ajax({
          url: '/sign/signIn',
          data: { email: email, password: password },
          type: 'post',
          success: function(json) {
            console.log(json);
          },
          error: function() {
            console.log("连接失败");
          }
        })
      })
      //获取用户名
      function getNickName() {
        var user = {};
        var cookies = {};
        var all = document.cookie;
        var list = all.split("; ");
        list.forEach(function(item) {
          var cookieItem = item;
          var p = cookieItem.indexOf("=");
          var name = cookieItem.substring(0, p);
          var value = cookieItem.substring(p + 1);
          value = decodeURIComponent(value);
          cookies[name] = value;
        })
        console.log(cookies);
      }
      </script>
</body>

</html>